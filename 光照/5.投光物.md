# 5.投光物

到目前为止，我们介绍的都是点光源。但是现实世界中，光源的类型却要相对复杂一些。大概会有这么几种形式：`定向光`、`点光源`、`聚光`等等。

### 定向光

当一个光源处于很远的地方时，来自光源的每条光线就会近似于互相平行。这点很好理解，生活中我们的太阳光，就可以近似看做是平行光。定向光的特点是，光线的防线与光源的位置没有关系，他们的光线方向都是相同的。

![定向光](https://learnopengl-cn.github.io/img/02/05/light_casters_directional.png)

在之前的例子中，我们都要通过光源的位置和物体上的顶点来计算光线射入的角度，从而计算漫反射分量和镜面光分量。如果是定向光，我们这直接可以拿到光线的射入角度。

这部分内容十分简单，只要将我们之前传入的用来计算光源方向的光源位置替换为光源方向直接使用即可。不过有一点需要注意的是：

> 我们首先对light.direction向量取反。我们目前使用的光照计算需求一个从片段至光源的光线方向，但人们更习惯定义定向光为一个从光源出发的全局方向。所以我们需要对全局光照方向向量取反来改变它的方向，它现在是一个指向光源的方向向量了。而且，记得对向量进行标准化，假设输入向量为一个单位向量是很不明智的。

这里在原教程中存在这样一个扩展：

> 我们一直将光的位置和位置向量定义为`vec3`，但一些人会喜欢将所有的向量都定义为`vec4`。当我们将位置向量定义为一个`vec4`时，很重要的一点是要将w分量设置为1.0，这样变换和投影才能正确应用。然而，当我们定义一个方向向量为`vec4`的时候，我们不想让位移有任何的效果（因为它仅仅代表的是方向），所以我们将w分量设置为0.0。
>
> 方向向量就会像这样来表示：`vec4(0.2f, 1.0f, 0.3f, 0.0f)`。这也可以作为一个快速检测光照类型的工具：你可以检测w分量是否等于1.0，来检测它是否是光的位置向量；w分量等于0.0，则它是光的方向向量，这样就能根据这个来调整光照计算了：
>
>  if(lightVector.w == 0.0) // 注意浮点数据类型的误差<br>
>  // 执行定向光照计算<br>
> else if(lightVector.w == 1.0)<br>
>  // 根据光源的位置做光照计算（与上一节一样）
>
> 你知道吗：这正是旧OpenGL（固定函数式）决定光源是定向光还是位置光源(Positional Light Source)的方法，并根据它来调整光照。

私以为，之所以要求`w分量等于1`是因为在坐标系统这一章中，我们了解到，`w分量`是用来做透视效果的。**而平行光是不具备透视效果的，所以我们将其w分量设置为1。**


