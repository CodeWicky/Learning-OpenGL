# 8.坐标系统

最开始我们就说过，GL中的坐标系是标准设备坐标，即他的每个坐标轴的取值范围都是[-1.0,1.0]。通常，我们输入到顶点着色器中的顶点坐标都会被转换为标准化设备坐标，然后进行光栅化，转变成屏幕坐标。然而事实上，从顶点坐标到屏幕坐标是一个较为复杂的过程。总体来讲为了某些计算更加方便，会经过5个坐标系统的变换：

- 局部空间(Local Space，或者称为物体空间(Object Space))
- 世界空间(World Space)
- 观察空间(View Space，或者称为视觉空间(Eye Space))
- 裁剪空间(Clip Space)
- 屏幕空间(Screen Space)

接下来，我们会具体讲一下这些坐标系统的意义。

### 概述

![流程图](https://learnopengl-cn.github.io/img/01/08/coordinate_systems.png)

经过了这么久的介绍，我们都一直在绘制屏幕中的一个矩形。**而事实上，之前的一切过程，我们还只是停留在建造模型的过程**。这时候我们的画布里只有这一个模型，我们把当前的坐标系统称作是`局部空间`。

当然，我们的屏幕中大多数情况下不可能只有一个模型，而是千千万万个模型。**我们应该通过一系列矩阵变换将模型变换到一个更大的画布中**。当然，我们的屏幕是不可能变大的，所以我们是通过一系列的矩阵缩放我们的模型然后放到原始画布中来模拟把模型放入大画布中这个过程。这里，我们把变换到大画布后的坐标系统称为是`世界空间`。而从局部空间变换到世界空间转换所需要的这个矩阵，我们成为`模型矩阵`。

我们知道，OpenGL是一个3维的世界，然而我们屏幕是一个2维的画面。就好像我们生活在3维空间中但是我们所观察的世界实际是以我们的眼睛作为起始点获取的3维空间在我们的视网膜上投影在将信息传给我们的大脑。那么OpenGL模拟了这个过程，首先我们需要一个眼睛，再其次我们需要将世界投影到我们的屏幕上。

在OpenGL中我们把这个眼睛称作是摄像机。而摄像机针对的坐标系统称为`观察空间`。我们从世界空间转换到观察空间所经过的矩阵为`观察矩阵`。**经过观察矩阵转换后，实际上我们看到的就是3维世界在我们摄像机所面对的方向上的一个投影了**。

生活中我们有一个常识，物体近大远小。物体距离我们越远，他看起来将会越小，我们把这种现象称为透视现象。然而在观察空间我们看到的投影缺不具备这种特点，我们把这种按照物体原比例显示的投影称为正投影。然而这样的投影却与我们平常所观察到的世界不一样，为了让事物看起来更加真实，我们要给物体加上透视效果。经过透视的投影，就是透视投影。GL中，**我们为了使物体具有透视效果，我们要将物体经过一个`透视投影矩阵`进行转换**，转换至的空间我们称为`裁剪空间`。之所以称为裁剪空间，是因为除了投食之外，我们还要把超出视野的地方裁减掉。而GL中就是把超出屏幕空间的物体裁减掉。所以称之为裁剪空间。

最后，**我们要把裁剪空间中的物体转换到我们的屏幕上进行输出**。屏幕输出的空间我们叫做`屏幕空间`。这个过程呢，就不用我们费心了，因为到了裁剪空间之后我们已经完全完成了模型到透视投影的转换。接下来只需要将这部分物体展示在屏幕上就好，所以这部分工作由GL替我们完成。这个过程，我们叫`视口变换`。视口变换将位于-1.0到1.0范围的坐标变换到由`glViewport`函数所定义的坐标范围内。最后变换出来的坐标将会送到光栅器，将其转化为片段。

到这里我们已经大概清楚了这些空间的作用，那么在对应空间中的坐标就分别称为`局部坐标(Local Coordinate)`、`世界坐标(World Coordinate)`、`观察坐标(View Coordinate)`、`裁剪坐标(Clip Coordinate)`和`屏幕坐标(Screen Coordinate)`。

### 组合

我们知道，从我们的局部空间到屏幕空间需要我们先把局部坐标转换至裁剪坐标，再交由GL转换为屏幕坐标。所以我们应该经过的过程就是：



